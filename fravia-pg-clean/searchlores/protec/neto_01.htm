
<HTML>
<HEAD>
<!--  formamus.htm version 02 February 1998
      INSTRUCTIONS FOR SUBMITTING: DO NOT USE HTML EDITORS!
      SEARCH THIS TEXT FOR THE STRING "Your_"
      AND REPLACE WITH WHATEVER YOU WANT TO PUBLISH!
      THANKS A LOT: this will allow automated retrieval -->
<TITLE>neto_01.htm How to crack another commercial "ready made" protection</TITLE>
<STYLE type="text/css"> A:link { color: #02F } A:visited  { color: #808 } A:hover { color: purple; background: #AFB } </STYLE></head>

<BODY bgcolor="#CCCCCC" TEXT=#001010 LINK=#0000FF ALINK=#00FF00 VLINK=#3366CC>
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH=
"100%  HEIGHT="22">
<TR><td></td>
<td>
<!-- Choose  a TITLE probably wont be changed -->
<center><FONT SIZE="+2">Rsagnt32.dll</fonT><br>
        <FONT SIZE="+1">How to crack another commercial "ready made" protection</fonT>
</center>
</td>

<td>
<!-- Choose  a PROJECT GIF, leave this if unsure -->
<center><a href="https://searchlores.nickifaulk.com/protec/timelock.htm"><IMG SRC="https://searchlores.nickifaulk.com/protec/timelock.gif"
ALT="timelock"
ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0
HSPACE=0></a>
<br>
<font color=gray>Timelock</FonT>
</center></td></tr>
<tR>
<td bgcolor="#FFFFEA"><center>
<FONT COLOR="890000">
<!-- CHOOSE A DATE (will probably be changed) -->
25 July 1998
</FONT></center>
</td>
<td bgcolor="#FFFFEA"><center>by <font size=+3>
<!-- CHOOSE A HANDLE (wont be changed) -->
Miguel Neto
</fonT></center>
</td>
<td VALIGN="center" bgcolor="#FFFFEA">
<!--
<a href="hcu98_3.htm"><IMG SRC="hcu1.gif" ALT="+cracker"
ALIGN=BOTTOM
WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>
-->
</td>
</tr>
<TR><td><center><a href="index.html"><IMG SRC="https://searchlores.nickifaulk.com/protec/bulletr.gif"
ALIGN="BOTTOM"
BORDER="0" VSPACE="0" HSPACE="0"></a></center></td>
<TD BGCOLOR="898030"><center>Courtesy of Fravia's page of
reverse engineering</center>
</center></TD>
<td BGCOLOR="898030">
<center>
<!-- Your truly+ will edit only if really necessary -->
slightly edited<br>
by fravia+</center></td>
</TR>
<!-- this is for the
data.....fra_00xx....yymmdd....handle..beg+int...not ass... -->
<tr><td><font
color="#C4C0CF">fra_00xx<bR>989715<br>Miguel Neto<br>1100<br>NA<br>PC<br
></fonT></td><td><i><center>
Well well, old timelock never dies... "Sales Agent" what for an ugly commercial 
oriented name. We'll have to build our own 'Sales antiagents' bots... Hey, why not? C'mon, let's have 
our "freedom agents"  
or -even better- "poetry agents"! I mean: what about our own simple perl robots roaming around and 
nuking automatically -for instance- all web sites where 'commerce' dominates and where 
there are no rhimes and no poetry at all? :-)<br>Ok, I'm dreaming (am I? :-) anyway 
just have fun with this simple protection scheme!
</i></center></td>
<td></td>
</tr>
<TR><td></td>
<!-- Leonard Coehn's old song, because we are poets, not only crackers
-->
<TD BGCOLOR="898030"><center></i><b>There is a crack, a crack in
everything
That's how the light gets in</b></center>
<!-- Leonard Coehn's old song, because we are poets, not only crackers
-->
</center></TD><td></td>
</TR>
<TR>
<td VALIGN= "MIDDLE" bgcolor="#C6E7C6"><font color=blue><center>
Rating</FONT></FONT></center>
</TD>
<td VALIGN = "MIDDLE" bgcolor="#C6E7C6"><font color=blue><center>
<!-- CHOOSE A RATING (may be changed) -->
(x)<B>Beginner</B> (x)<B>Intermediate</B> ( )<B>Advanced</B> (
)<B>Expert</B></FONT>
</center></td>
<td></td>
</tr>
</table>
<!-- END HEAD  -->
<hr>
<!-- CORPUS  -->

<!-- CHOOSE A COMMENT (may be changed)  -->
This is an essay aimed at begginers and intermediate crackers alike; it
will
hopefully teach you how to crack
another commercial "already made" protection, Sales Agent (Time Lock
protection style)<hR>
<center>
   <FONT SIZE="+2">
<!-- CHOOSE A TITLE (wont probably be changed) -->
How to crack Sales Agent
   </FONT><BR>
   <FONT SIZE="+2">
<!-- CHOOSE A SUBTITLE (wont proabbly be changed) -->
An example: Macromedia Dreamweaver
   </FONT><BR>
   <FONT COLOR="0B7FC1">
<!-- REPEAT YOUR CHOSEN HANDLE HERE -->Written by
Miguel Neto
   </FONT>
</center><br><br>

<!-- INTRO STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH=
"100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font
color=blue>Introduction</fonT>
</fonT></center></td></tr></table>
<br>
<p>
Hello, HCUkers. My name is Miguel Neto. Beeing the less than average cracker that I am, and
therefore
don't having to fear censors, I don't see why I should use a nicknname.
 I am
going
to introduce you to another commercial protection scheme,
"tl32v20.dll
style".
This one is called rsagnt32.dll. As you will see, it is hardly more
difficult to
beat than the more widespread <A HREF=
"<a href="http://www.fravia.net/timelock.htm">TimeLock</A>.
<p>
The main program I am aware of that uses this "Sales Agent" is
Dreamweawer, a wiespread web-design and site-administration utility.<br>
I apologize for the size of the target, I know it is very big, but most
commercial
applications are (IE4, NETSCAPE4, Norton's recent products, etc...).<br>
Anyway,
it
shouldn't take all too much to download, even on a slow
connection, once you have ftpgetted it from the web (alternatively you'll 
find it on many magazine covers published in the period April-July 1998).
<p>
Even though this target proved very easy to defeat, I thougt it would be
worth
sending
my essay to fravia+ because of the protection it uses, which has been 
made by a third party
company.<br>
You will probably encounter the same scheme in many other products.<br> 
Ok, enough rambling, let's crack!
  <!-- PASTE HERE YOUR INTRODUCTION -->
</p>
<!-- TOOLS STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH=
"100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Tools
required</fonT>
</fonT></center></td></tr></table>
Soft-Ice 3.2
Wdasm, any version should do  <!-- PASTE HERE YOUR REQUIRED TOOLS --
>
<br><br>

<!-- TARGET URL STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH=
"100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font
color=blue>Target's
URL/FTP</fonT>
</fonT></center></td></tr></table>
<a href="ftp://ftp.pcworld.com/pub/internet/html_editors/dreamweaver.exe">ftp://ftp.pcworld.com/pub/internet/html_editors/dreamweaver.exe</a> Get it here</a><br><br>
The version I am using is 1.0, because I already had it on my hard
disk. I don't
know if more recent versions still have the same protection scheme. The
setup
file for version 1.0 is 5.5 mb and is called dreamweaver.exe

<!-- REAL ESSAY  STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH=
"100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font
color=blue>Essay</fonT></fonT>
</center></td></tr></table>

<p>
First of all, install Dreamweawer. The installation asks you for a
serial number,
you don't have to enter one just yet. Ok, let's try and register it.
After
searching for a while, we conclude that there is no obvious way to
register
("This product is using a DEMO serial and does not need to be
registered").<br>
The only protection appears to be the 30 day trial. Ok, so set your
clock one
month
forward to see what happpens. There you go! Dreamweaver expired! Now
reset
your clock
to it's original state and restart Dreamweaver. Doh! I doesn't work!<br>
Dreamweaer
is gone
forever, at least until you crack it... This must be one of those
"diode protections"
+ORC mentioned to us...<br>
No matter, we won't go that way... Cracking a time trial is never a
*clean*
crack,
the program is never 100% complete that way, you never know what can
happen 1 month
from later. So, start Dreamweaver and select buy. Quite a fancy screen
we
have here.<br>
Doesn't look like it is really a part of Dreamweaer proper does it? No references to the
program or
to Macromedia whatsoever... Let's see where does this beautiful screen
live...<bR>
Fire up Soft-ice and set a breakpoint on getdlgitemtexta and on
getwindowtexta.<bR>
Enter some stuff to fill out the fields and press enter. Soft-ice fires
up in
Kernel32 (the dll where dlgitem and windowtext live), press F12 to go
back to
whatever
called that function, and you see that it rsagnt.<br>
A new kid on the
block! Using
the Find feature of windows95, we discover that the correspondent dll
is on
Dreamweaver's directory (At least Macromedia had the decency of not
concealing 
it in the
windows/system). Let's disassemble the babe! If you haven't prepared
your
drink and
set up your music yet, don't bother, because we are practically
finished...<br>
Once Wdasm has finished disassembling, go to string references. Check
them.<br>
Examine
each and every one of them. This is the most difficult part of the
cracking, even
if
it is always pretty easy. You will eventually find a  "Thank You", which is
not bad at all as 'fishing point'... 
but there is also a "This is a Demo. Unlocking", which is much better.<br>
Double
click
that reference and you will end up here:
<prE>
* Referenced by a CALL at Address:10003DF6
|
:10003F40 81EC70020000            sub esp, 00000270
:10003F46 833DA8DD021000          cmp dword ptr [1002DDA8], 00000000
:10003F4D 53                      push ebx
:10003F4E 56                      push esi
:10003F4F 57                      push edi
:10003F50 55                      push ebp
:10003F51 7532                    jne 10003F85; remember this!!!
:10003F53 8B9C2484020000          mov ebx, dword ptr [esp+00000284]
:10003F5A 6A40                    push 00000040

* Possible StringData Ref from Data Obj ->"SalesAgent Demo"
                                  |
:10003F5C 688C500210              push 1002508C

* Possible StringData Ref from Data Obj ->"This is a demo. Unlocking"
                                  |
:10003F61 6858500210              push 10025058</prE>

So, if at 3DF6 the program calls this, that means that it pretty much
knows that
everything is set, that the user has payed his 269$ (Oh my!), and that it
can go on
with the unlocking. So, let's see what happens at EDF6. Scroll up a bit
and you
will see:<pRE>
* Referenced by a Jump at Address:10003DDA(C)
|
:10003DF1 8B742448                mov esi, dword ptr [esp+48]
:10003DF5 56                      push esi
:10003DF6 E845010000              call 10003F40</prE>

Haha! A conditional jump! So, if at 3DDA the program breaks, than the
program
will
probably be registered! Fire up soft-ice, recreate or enable the
breakpoint at
getdlgitemtexta and select BUY from the Dreamweaver nag. Enter some text
and press
enter. Soft-Ice will break and you will be able to set the breakpoint at
10003DDA
on rsagnt. Ok, now clear all breakpoints exept the last one, fill in
the fields, and
continue. We now have another screen asking us information about out
credit
card,
just enter a bunch of keys for the credit card number, and some
balloney info
about
yourself, and you are ready to go. There is no need to check for credit
card
info at
this point, since you are still offline, so if you enter 13 numbers the
program will
probably accept them. If not, just enter your expired credit card info,
don't
worry,
we'll never go online with it. Press enter and voilï¿½! Soft-ice breaks
at the
conditional jump. Change the flag and the program will jump. Now, if you
remember
correctly, right before the "Unlocking" string showed up, there was a
conditional
jump, at 3F51. So we will have to trace the function and change this
flag to. At
this point, you can press F5 and you are ready to go! There is no need
to
patch
since the program only checks this call once! The program is unlocked.
<p>
Now we start Dreamweaver, thinking that we are registered, only to
discover
that
there is another serial number to be entered. Before I explaine this
protection,
there is something you must know. When I began writting this tutorial,
I said to
myself: "Miguel, you are just a begginer! So don't go around
criticizing the way
Dreamweaver or the protection is made, just crack! You'll end up making
a fool
of
yourself!" But now I find it impossible to contain myself. Just
disassemble
Dreamweaver yourself
 and you will see what I mean; God know why, Macromedia already gave you
the first
letters of the code, DWW100-. Now, if you look at the references, you
will find
a
nice string like this: DWW100-07785-53546-55079.<p>"It can't be"-you
shout.<bR> It
is.<bR>
It seems that the boys at Macromedia wanted to give us a taste of their
protection
skills, as well as a motif as why they chose this commercial
protection. It makes
me
laugh! THIS is the way a 269$ software is protected... Now, level with
me, you would not have
found yourself a more stupid way to protect than to <u>hardcore<u> the serial into the
file itself would have
you?<br>
HA HA AH... My tummy hurts... My back hurts... ha ha ha...
Thank god this tutorial is finished!!
</p>

<!-- FINAL NOTES STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH=
"100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Final
Notes</fonT>
</fonT></center></td></tr></table>
<pre>
You now have another weapon in your arsenal, the knowledge to crack
SalesAgent,
let's hope more and more software companies decide to buy this
protection.
Protections are getting easier each day my friend, people are getting
more
stupid
each day, if you don't go with the flow, if you don't forget that
knowledge is the
Ultimate Weapon, we have nothing the fear, quite on the contratry...

I would like to thank +Fravia for all his efforts. His site is the only
one in the
web that rises cracking to an art form, and I can only hope to become
half
the cracker he is.
  <!-- PASTE HERE YOUR FINAL NOTES (if any) -->
</pre>
<br><br>

<!-- OB DUH STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" WIDTH=
"100%"  HEIGHT="22" >
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Ob
Duh</fonT></fonT>
</center></td></tr></table>
 <center>
   <i>I wont even bother explaining you
   that you should BUY this target program if you intend to use it for
a longer
   period than the allowed one. Should you want
   to STEAL this software instead, you don't need to crack its
protection
   scheme at all: you'll
   find it on most Warez sites, complete and already regged,
farewell.</i>
</center>

<!-- WAY OUT STARTS HERE -->
<hr>
<center><i>You are deep inside fravia's <a href="https://searchlores.nickifaulk.com/protec/searchlores.org">searchlores org</a>,
choose your way out:</i></center>
<br><center>
<!-- EITHER A NICE GIF LIKE THIS -->

<!--
<a href="project3.htm"><IMG SRC="project3.gif"
ALT="projecT3" ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0
VSPACE=0 HSPACE=0></a>
<br>
<font color=gray>Back to project 3</FonT>
<br><bR>
-->

<!-- OR JUST A LINK LIKE THIS -->

<!--
<IMG SRC="bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="project1.htm">Back to
Your_chosen_project</A>
<hr width=33%>
-->

<IMG SRC="https://searchlores.nickifaulk.com/protec/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="index.html">homepage</A>
<IMG SRC="https://searchlores.nickifaulk.com/protec/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="https://searchlores.nickifaulk.com/protec/links.htm">links</A>
<IMG SRC="https://searchlores.nickifaulk.com/protec/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="https://searchlores.nickifaulk.com/protec/searengi.htm">search_forms</A>

<IMG SRC="https://searchlores.nickifaulk.com/protec/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="https://searchlores.nickifaulk.com/protec/orc.htm">+ORC</A>
<IMG SRC="https://searchlores.nickifaulk.com/protec/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="https://searchlores.nickifaulk.com/protec/student.htm">students'
essays</A>
<IMG SRC="https://searchlores.nickifaulk.com/protec/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="https://searchlores.nickifaulk.com/protec/academy.htm">academy
database</A>
<br>
<IMG SRC="https://searchlores.nickifaulk.com/protec/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="https://searchlores.nickifaulk.com/protec/realicra.htm">reality
cracking</A>
<IMG SRC="https://searchlores.nickifaulk.com/protec/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="https://searchlores.nickifaulk.com/protec/howtosea.htm">how to
search</A>
<IMG SRC="https://searchlores.nickifaulk.com/protec/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="https://searchlores.nickifaulk.com/protec/javascri.htm">javascript
wars</A>
<br>
<IMG SRC="https://searchlores.nickifaulk.com/protec/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="https://searchlores.nickifaulk.com/protec/tools.htm">tools</A>
<IMG SRC="https://searchlores.nickifaulk.com/protec/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="https://searchlores.nickifaulk.com/protec/noanon.htm">anonymity
academy</A>
<IMG SRC="https://searchlores.nickifaulk.com/protec/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="https://searchlores.nickifaulk.com/protec/cocktail.htm">cocktails</A>
<IMG SRC="https://searchlores.nickifaulk.com/protec/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A
HREF="<a href="http://fravia.net/ideale.htm" target=_blank>http://fravia.net/ideale.htm</a>">antismut CGI-scripts</A>

<IMG SRC="https://searchlores.nickifaulk.com/protec/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="https://searchlores.nickifaulk.com/protec/info.htm">mail_fravia+</A>
<br>
<IMG SRC="https://searchlores.nickifaulk.com/protec/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><A HREF="https://searchlores.nickifaulk.com/protec/legal.htm">Is reverse
engineering legal?</A>
</CENTER>
<hr>
<!-- THAT'S ALL, THANKS A LOT this will allow automated retrieval -->
</BODY>
</HTML>
</font></pre>




 <form method=post action="https://searchlores.nickifaulk.com/py/nfLttr.py?Pyt=Tnf&amp;box=Inbox&amp;message=903_2339482_65367_739_18455_0&amp;sort=date&amp;NEX=1&amp;order=down&amp;inc=25&amp;num=1&amp;YY=6695&amp;pos=0">
<table width=100% border=0 cellpadding=0 cellspacing=1>
<tr><td bgcolor="#dcdcdc">
<table cellpadding=1 cellspacing=1 border=0 width=100%>
<tr>
<td nowrap>
<font face="Arial,Helvetica" size=-1>
<input type=submit name=TRA value=Delete> Message - <a href="https://searchlores.nickifaulk.com/py/nfLttr.py?Pyt=Tnf&amp;toc=1&amp;box=Inbox&amp;message=903_2339482_65367_739_18455_0&amp;sort=date&amp;order=down&amp;inc=25&amp;num=1&amp;YY=6695&amp;pos=0"><b>Download</b></a>
</font>
</td>
<td align=right nowrap>
<select name=destBox1>
<option value="">- Choose Folder -













<option>start1</option>


</select>
<input type=submit name=MV1 value=Move>
</td>
</tr>
</table>
</td></tr>
</form>
<form method=post action="https://searchlores.nickifaulk.com/py/nfCmp.py?Pyt=Tnf&amp;folder=Inbox&amp;YY=6695" name=reForm2>
<input type=hidden name=message value="903_2339482_65367_739_18455_0">
<input type=hidden name=Subject value="From Miguel Neto">
<tr><td>
<table cellpadding=1 cellspacing=1 border=0 width=100%>
<tr>
<td nowrap>
<input type=submit name=reply value=Reply> <input type=submit name=replyAll value="Reply All">
<input type=submit name=forward value=Forward>
<font face="Arial,Helvetica" size=-2>
<select name=fwdoption>
<option value=attach >as attachment
<option value=quoted SELECTED>inline text
</select>
</font>
<font face="Arial,Helvetica" size=-1>
-

<a href="https://searchlores.nickifaulk.com/py/nfLttr.py?Pyt=Tnf&amp;box=Inbox&amp;message=903_2339482_65367_739_18455_0&amp;sort=date&amp;PRE=1&amp;order=down&amp;inc=25&amp;num=1&amp;YY=6695&amp;pos=0"><b>Prev</b></a> | 

<a href="https://searchlores.nickifaulk.com/py/nfLttr.py?Pyt=Tnf&amp;box=Inbox&amp;message=903_2339482_65367_739_18455_0&amp;sort=date&amp;NEX=1&amp;order=down&amp;inc=25&amp;num=1&amp;YY=6695&amp;pos=0"><b>Next</b></a>

</font>
</td>
<td align=right nowrap>
<font face="Arial,Helvetica" size=-1>
Back to
<a href="https://searchlores.nickifaulk.com/py/nfMBox.py?Pyt=Tnf&amp;box=Inbox&amp;sort=date&amp;order=down&amp;YY=6695&amp;pos=0"><b>Inbox</b></a>

</td>
</tr>
</table>
</td></tr>
</table>
</form>
 
<BR>
<font size=-1><i>Copyright &#169; 1997-98 <a href="http://www.yahoo.com" target="_blank">Yahoo!</a> Inc. All rights reserved.</i></font>
</td></tr></table>

<p>
<!--YahooMail-->
</body>
</html>



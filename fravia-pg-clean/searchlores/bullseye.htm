<html>
<head>
  <!-- web searching lore: pagename begin -->
  <title>(¯`·.¸(¯`·.¸ bullseye.htm ¸.·´¯)¸.·´¯) www.searchloress</title>
  <!-- web searching lore: pagename end -->
  <meta http-equiv="Content-Type"   content="text/html; charset=iso-8859-1">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <meta http-equiv="Content-Script-Type"  content="text/java-script>
  <meta name="description"  content="This site teaches basic and advanced search techniques for people interested in finding any kind of information on the web. Here are informations, documents, links, etc. related to web-searching">
  <meta name="keywords"   content="searching, combing, klebing, how to search, search techniques, hints and tips for searching the web, How do I learn to search?, Advanced Internet searching, How do I search the web?, fravia+">
  <meta name="author"   content="fravia+">
  <meta name="copyright"    content="Copyright(c) 1952-2032 fravia+">

  <STYLE type="text/css">
  A:link { color: #02F }
  A:visited  { color: #808 }
  A:hover { color: purple; background: #AFB }
  </STYLE>
  </head>
  <body bgcolor="#CCCCCC" TEXT=#001010 LINK=#0000FF ALINK=#00FF00 VLINK=#3366CC>
  <!-- fravia's searching lore: bigtitle, begin -->
  <center>


  <!-- internet searching techniques: imageheader begin -->
  <table><tr><td><center><font size=+3>~ Essays ~</font>

  <br>
  <table border="0" ALIGN=CENTER><tr>
  <th bgcolor="#993300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>
  <TH BGCOLOR="#993300">&nbsp;&nbsp;</th>
  <th BGCOLOR="#993300"><a href="essays.htm"  target="_blank"><img 
  SRC="images/basipet.jpg" ALT="to essays"
  ALIGN=BOTTOM WIDTH="118" HEIGHT="68" BORDER=0 VSPACE=0
  HSPACE=0></a></th>
  <TH BGCOLOR="#993300">&nbsp;&nbsp;</th>
  <th bgcolor="#FF0000"><Font color="#993300" SIZE="3">
  essays</th>
  </tR></table>
  </center></td>
  <td>&nbsp;&nbsp;&nbsp;</td>
  <td> <center><font size=+3>~ Bots Lab ~</font>
  <!-- fravia's searching lore: bigtitle, end -->
  <br>
  <table border="0" ALIGN=CENTER><tr>
  <th bgcolor="#993300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>
  <TH BGCOLOR="#993300">&nbsp;&nbsp;</th>
  <th BGCOLOR="#993300"><a href="bots.htm"  target="_blank"><img 
  SRC="images/basipet.jpg" ALT="to bots"
  ALIGN=BOTTOM WIDTH="118" HEIGHT="68" BORDER=0 VSPACE=0
  HSPACE=0></a></th>
  <TH BGCOLOR="#993300">&nbsp;&nbsp;</th>
  <th bgcolor="#FF0000"><Font color="#993300" SIZE="3">
  bots lab</th>
  </tR></table></center></td>
  
  </tr></table>(Courtesy of fravia's <a href="http://www.searchlore.org">searching
  lores</a>)<br><bR>
  <!-- internet searching techniques: imageheader end -->

  <FONT SIZE=+3>(¯`·.¸&nbsp;Hitting The BullsEye&nbsp;¸.·´¯)</font>
  <br>
 
  <br>
  <font size=+2>by CiNiX</FONT>
  <BR>
  (slightly edited by fravia+)
  <br>
  published at  <a href="http://www.searchlores.org"  target="_blank">searchlores</a> in 
  Mai 2001
  <br>
  <hr width=44%><i>
A very interesting essay by CiNiX, covering Bullseye (after the recent essays about 
</i><font color=blue>[</font><a href="cope_wot.htm">Copernicus</a><font color=blue>]</font> 
<i>and </i>
<font color=blue>[</font><a href="lexi_lau.htm">lexibot</a><font color=blue>]</font>. 
<i>
<br>
What should I say? Clearly it seems that there are SO MANY bots around that we'll always be able to 'collate' them 
back to an understandable script, no matter how encrypted their handshakes are... eheh: the web
 was <u>built</u> in order to SHARE, not to HOARD knowledge...<br><br>

Bullseye, the  target of this essay by  CiNiX, 
is another searchbot, or searchagent, an agent being "software that knows how to do things that you could 
              do if you had the time")<br>According to 
               Sundar 
              Kadayam (the cofounder and CTO of Intelliseek, makers of Bullseye) 
              there are "<font color= "#008080">six major task areas thats a search bot 
              must undertake on behalf of the user... <b>1)</b>: Expand search coverage to cover distributed sources and the 
                &quot;invisible Web&quot; <b>2)</b>: Guarantee freshness by eliminating dead links and removing stale 
                hits with non-matching content <b>3)</b>:  Improve relevance by adding quality metrics and incorporating 
                user feedback <b>4)</b>: Analyze and filter out irrelevant documents and cluster/categorize 
                to aid visualization of data <b>5)</b>: Report and collaborate by annotating and generating reports 
                and aiding in collaboration with other agents <b>6)</b>: Track and alert through continuously monitoring sources and 
                alerting the user when key things are found"</font>. As you can see, Bullseye raises big expectations... <br>This essay is short, but simple only for those that have read the recent exploits of 
                the </i><font color=blue>[</font><a href="http://www.213.ch/phplab/oslse.htm">oslse project</a><font color=blue>]</font><i>... yet it will require some background reading for those that until now 
                did not work along our efforts.<br> 
               Alee! The moment has come, for accomplished searchers, to learn some simple 'black' magic. Enjoy!</i><br><hr>
  
</center>
<H2>Hitting The BullsEye</h2>

<h2>by CiNiX</H2>
</CENTER>

<H2>Preparation</H2>
<P></P>
<H3>Target</H3>
<P>
BullsEye 2 - <a href="http://www.intelliseek.com">IntelliSeek</a>
</P>
<H3>Tools</H3>
<P>
<PRE>
1/4 Brain  - You really don't need the rest ;)
C Compiler - For writing the decoder tool: bullsdec.exe <a href="zipped/bullsdec.zip">bullsdec.zip</a> from CiX
[that's all folks!] 
</PRE>
</P>
<H2>Introduction</H2>
<P>
Once upon a time... there was a little boy that wandered around in the big World Wide Web until he stumbled upon a site with huge amounts of knowledge. The little boy started reading, reversing, seeking and searching until he was showing the early sympthoms of information overload and he desided that the time had come to step forward, write his own essay and contribute...
</P>
<P>
When reading the essay's by WayOutThere and Laurent about offline search bot reversing, I remembered having a copy of an offline search tool called BullsEye. I took a little peek in the 'hidden' engine directory and found about 897 engine files, mucho interesting information for the people that work on the oslse project! Let's see how we can make it usefull.
</P>  
<H2>The first steps</H2>
<P>
I started opening some of the engine files in an ordinary text editor and was happely surprised to see they had the format of an .ini file, the ones you read from with 'GetPrivateProfileStringA' and 'GetPrivateProfileIntA'.
</P>
<P>
The all looked a lot like this:
<PRE>
[Data]
Name=Vhi Shf Zig Zmjbnt
DisplayName=Vhi Shf Zig
Id=431
Version=22
FormPageURL=cpqn:+,yza/gstcrpirp*sfe/
SearchEnginePageURL=cpqn:+,yza/gstcrpirp*sfe/
HelpPageURL=
Cookies=2
CanTrack=2
Server=rst(zlmvkibki#lyx
GET=2
QTEngine=Vhi shf Zig
QueryString=&ydg(bjp.wjgykq?bgrfn=#k
MonitorQueryString=&ydg(bjp.wjgykq?bgrfn=#k
QTFormOptions=LP^LNNF
AD=1
Description=Awpr Sfcugm:  Jvw gvt Nwu- Wij tig Xnsl

[Registration]
more data ...
</PRE>
So only the value's of the keys are encoded. Humm...let's see if we can replace them with something that makes sense. The filename was AllThe00.eng so could the Name= value be something like All The Web ???
<PRE>
Name=Vhi Shf Zig Zmjbnt
Name=All The Web ??????

DisplayName=Vhi Shf Zig
DisplayName=All The Web
</PRE>
Other values that can be decoded? any URL's that start with http://www.? It's supposed to be a search tool so: Yes!  
<PRE>
FormPageURL=cpqn:+,yza/gstcrpirp*sfe/
FormPageURL=http://www.alltheweb.com/

SearchEnginePageURL=cpqn:+,yza/gstcrpirp*sfe/
SearchEnginePageURL=http://www.alltheweb.com/
</PRE>
So what can we learn from this? All the uppercase characters are encoded as uppercase and all the lowercase characters are encoded as lowercase. Spaces don't seem to be encoded at all!
</P>
<P>
The encryption routine is more than some substitution else the two t's should be encoded the same. Even as the three w's, so encoding is partially based on the position of the character in the string. Look at the t's isn't the q one place further in the alphabet than the p? Look at the w's, so the encryption for lowercase characters is something like this:
<PRE>
encoded_char = char + encrement + position_in_string;
</PRE>
Some counting tells me that the encrement for lowercase is 0x15 (21), so our lowercase decoding routine should look like: 
<PRE>
<B>if</B>(character >= 0x61 && character <= 0x7A)<B>{</B>
   character = character - 0x15 - offset;
   <B>while</B>(character < 0x61)
      character =- 0x1A;
<B>}</B>
</PRE> 
trying this routine on the engine file gives us something like this:
<PRE>
Name=Vll She Zeb Zearch
DisplayName=Vll She Zeb
FormPageURL=http:+,www/alltheweb*com/
SearchEnginePageURL=http:+,www/alltheweb*com/
</PRE>
We're on the right track and I haven't looked at the code of BullsEye yet, I really think I'm not going to look! 
</P>
<H2>Further Investigation</H2>
<P>
After some experimenting I came to these conclusions:
</P>
<P>
BullsEye uses these ranges of characters to encode them:
<PRE>
[0x61] -> [0x7A] (a-z) encrement: 0x15
[0x41] -> [0x5A] (A-Z) encrement: 0x15
[0x21] -> [0x2F] (!-/) encrement: 0x06
[0x30] -> [0x39] (0-9) encrement: 0x01
[0x5B] -> [0x60] ([-') encrement: 0x03
[0x7B] -> [0x7E] ({-~) encrement: 0x01
</PRE>
After encoding these routines in our decoder the result is something like this. Easy to read;)
<PRE>
[Data]
Name=All The Web Search
DisplayName=All The Web
Id=318
Version=10
FormPageURL=http://www.alltheweb.com/
SearchEnginePageURL=http://www.alltheweb.com/
HelpPageURL=
Cookies=1
CanTrack=1
Server=www.alltheweb.com
GET=1
QTEngine=All the Web
QueryString=/cgi-bin/search?query=%s
MonitorQueryString=/cgi-bin/search?query=%s
QTFormOptions=QT_NONE
AD=0
Description=Fast Search:  All the Web, All the Time

[Registration]
Required=0

[NextHits]
DoNextHits=1
URLTEXTSusbtr=Next
URLHREFSubstr=/asearch?
HitsPerPage=10

[ExtractHits]
How=EXCLUDELINKSINSAMEDOMAIN
IncludeList=
ExcludeList=SA->http://ftpsearch.lycos.com/ SA->http://mp3.lycos.com/ SA->http://www.innit.com/ SA->http://www.fa-premier.com/ SA->http://web.fast.no/company/det.asp?id=8 SA->http://web.fast.no/company/contact/det.asp?id=19 SA->http://www.dell.com/ SA->http://www.dell.com SS->ftpsearch.lycos.com/cgi-bin/search?query= SA->http://www.fast.no/ SA->http://www.fast.no/company.html SA->http://www.fast.no/contact.html SA->http://richmedia.lycos.com/ SA->http://listeningroom.lycos.com/ SS->www.fast.no
DeliversSingleHitAsResultPage=0
NoMatchesId="No Hits."

[TrackExtractHits]
DynUrl=0

[Summary]
Available=1
StartFrom=DD
StopAt=BR
</PRE>
</P>

<P>
(c) CiNiX 2001. lord_cinix(at)hotmail(point)com
</P><font size=+1><center>
<table><tr><td><center>
<table border="0" ALIGN=CENTER><tr>
<th bgcolor="#993300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>
<TH BGCOLOR="#993300">&nbsp;&nbsp;</th>
<th BGCOLOR="#993300"><a href="essays.htm"  target="_blank"><img 
SRC="images/basipet.jpg" ALT="to essays"
ALIGN=BOTTOM WIDTH="118" HEIGHT="68" BORDER=0 VSPACE=0
HSPACE=0></a></th>
<TH BGCOLOR="#993300">&nbsp;&nbsp;</th>
<th bgcolor="#FF0000"><Font color="#993300" SIZE="3">
Back to essays</th>
</tR></table>
</center></td>
<td>&nbsp;&nbsp;&nbsp;</td>
<td>
<!-- fravia's searching lore: bigtitle, end -->

<table border="0" ALIGN=CENTER><tr>
<th bgcolor="#993300">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</th>
<TH BGCOLOR="#993300">&nbsp;&nbsp;</th>
<th BGCOLOR="#993300"><a href="bots.htm"  target="_blank"><img 
SRC="images/basipet.jpg" ALT="to bots"
ALIGN=BOTTOM WIDTH="118" HEIGHT="68" BORDER=0 VSPACE=0
HSPACE=0></a></th>
<TH BGCOLOR="#993300">&nbsp;&nbsp;</th>
<th bgcolor="#FF0000"><Font color="#993300" SIZE="3">
Back to bots lab</th>
</tR></table></center></td>
  
</tr></table><tR><td width= "300" height= "2"  bgcolor= "#993300"></tD></tR></table>
(c) III Millennium: <font color= blue><font color= blue>[</fonT></font><a
href="info.htm"  target="_blank">fravia+</a><font  color= blue><font color= blue>]</fonT></font>, all rights
reserved
<!-- how to search the web, by fravia+, signet end -->

<!-- begin da closing bit, duh -->
</CENTER>
</body>
</HTML>  